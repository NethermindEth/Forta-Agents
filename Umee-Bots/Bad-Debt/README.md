# Detect Bad Debt Bot

## Description

This bot monitors detect when the user's borrow value is more than his collateral value after performing a deposit, withdraw, swap, flash loan or borrow. The bot's behavior can be customized in `src/agent.config.ts`.

## Supported Chains

- Ethereum

## Alerts

- UMEE-11
  - Fired when the borrowed value becomes is greater than the collateral value after a Umee market interaction.
  - Severity is always set to "High"
  - Type is always set to "Exploit"
  - Metadata contains:
    -  `collateralAmount` The user collateral amount in ETH
    -  `borrowAmount` The user borrowed amount in ETH

## Test Data

### Kovan Testnet (PoC)

The following test was generated by interacting with PoC contracts (available at the `PoC/` directory) deployed on the Kovan testnet.

To check the results, uncomment the lines indicated in `src/agent.config.ts` set a Kovan testnet RPC (e.g. `https://kovan.poa.network`) as `jsonRpcUrl` in your `forta.config.json` file and run:

```
npm run tx 0xcd98d8d7d146c490c96175f676bf4582faca36070d7540a53b425389ca4c15b6
```

In this transaction, an account calls `MockLendingPool.borrow()` and, because `MockLendingPool.getUserAccountData()` will return a collateral value less than the borrow amount for any account (in this case the account to be checked would be the borrow `onBehalfOf` address), a finding will be emitted.